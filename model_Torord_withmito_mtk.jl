
using ModelingToolkit


@parameters t AcCoA Aff BSLmax BSRmax CIK CPN CRT_cyto CRT_mito CaMKo Cm Cmito CoA DpH Dpsio EtCS EtID EtKG EtMD EtSDH F FAD FADH2 Fjunc GClB_b GClCa_b GK1_b GKb_b GKr_b GKs_b GLU GNa GNaL_b Gncx_b GpCa_b Gto_b H HTRPNtot H_mito ICaCl_Multiplier ICaL_Multiplier ICaL_fractionSS ICab_Multiplier IClb_Multiplier IK1_Multiplier IKb_Multiplier IKr_Multiplier IKs_Multiplier INaCa_Multiplier INaCa_fractionSS INaK_Multiplier INaL_Multiplier INa_Multiplier INab_Multiplier IpCa_Multiplier Ito_Multiplier Jrel_Multiplier Jrel_b Jup_Multiplier K1ATP_NaK KAATeq KACOeq KADP KCS KFHeq KSLeq K_ipCa K_m1pCa K_m2pCa KaCa Kca KdClCa Kh1 Kh2 Kh3 Kh4 Khp KiADP_NaK KiFUM KiOxaa Ki_AM KidhNADH Kioaa Kiprime_up Kiup Kki Kko KmATP_AM KmAcCoA KmBSL KmBSR KmCaAct KmCaM KmCaMK KmCap KmIDNAD KmKG KmKGNAD KmOaa KmSucc Kmal Kmg Kmgatp Kmiso KmmNAD Kmn Kmup Kna Knai0 Knao0 Knap Knca Koff Kxkur L LTRPNtot L_cell La Lb Lm_prime Lz Mg MgADP MgATP PCa_b PCab PKNa PNab Pi Pnak_b R SL T VATPase_cyto V_AM_max V_AM_scaler VmDT VmNC Vmuni aCaMK alpha_1 b bCaMK beta_1 bt cao celltype clo cmdnmax_b csqnmax delta dielConstant eP f_xb fm g g_01_off gh gmin_xb hm i_Stim_Amplitude i_Stim_Period i_Stim_PulseDuration i_Stim_Start jsrMidpoint k1m k1p k2m k2n k2p k3m k3p k4m k4p kIDH kKGDH kMDH kSDH kTrop_pn kact kasymm kcaoff kcaon kcnsASP keq kf1 kfAAT kfACO kfFH kfSL kf_2 kf_3 kh_1 kh_2 khtrpn_minus khtrpn_plus kltrpn_minus kltrpn_plus kmcmdn kmcsqn kmtrpn kna1 kna2 kna3 ko kres kresf kt_2 ktrans n nID nKG na nao p1 p2 p3 pa pb pc1 pc2 qca qna r1 r2 r3 ra rad_ rb rc1 rc2 rhoF1 rhoREF rhoREN tauCa tauK tauNa thL tjca trpnmax wca wna wnaca zca zcl zeta zk zna
D = Differential(t)


@variables hL(t) jca(t) a(t) ap(t) m(t) ff_(t) fs(t) mL(t) xs1(t) HTRPNCa(t) CaMKt(t) hLp(t) h(t) hp(t) j(t) d(t) fcaf(t) fcas(t) fcafp(t) ffp(t) xs2(t) C0(t) C1(t) O_(t) iF(t) iS(t) nca_ss(t) nca_i(t) ASP(t) P3(t) ATPi_cyto(t) CrPi_cyto(t) CrPi_mito(t) Succ(t) FUM(t) jp(t) C2(t) I_(t) iFp(t) iSp(t) P2(t) ISOC(t) MAL(t) Oaa(t) cajsr(t) AKG(t) SCoA(t) Cam(t) N1(t) P0(t) P1(t) cansr(t) ADPm(t) Dpsi(t) NADH(t) kss(t) LTRPNCa(t) ATPi(t) ki(t) Jrel_np(t) Jrel_p(t) cai(t) nai(t) cass(t) nass(t) v(t)


    observed = [
        cli ~ 24.0,
tenDiv9 ~ 10.0 / 9.0,
twoThirds ~ 2.0 / 3.0,
ADP ~ 8.0 - ATPi,
inv_ATPi ~ 1.0 ./ ATPi,
ATPm ~ -ADPm + Cm,
Afcaf ~ 0.3 + 0.6 ./ (exp((v - 10.0) / 10.0) + 1.0),
AiF ~ 1.0 ./ (exp((v - 213.6) / 151.2) + 1.0),
ah ~ ((v >= -40.0) ? (0.0) : (0.057 * exp((-(v + 80.0)) / 6.8))),
aj ~ ((v >= -40.0) ? (0.0) : (((v + 37.78) .* ((-25428.0) * exp(0.2444 * v) - 6.948e-06 * exp((-0.04391) * v))) ./ (exp(0.311 * (v + 79.23)) + 1.0))),
ass ~ 1.0 ./ (exp((-(v - 14.34)) / 14.82) + 1.0),
assp ~ 1.0 ./ (exp((-(v - 24.34)) / 14.82) + 1.0),
bh ~ ((v >= -40.0) ? (0.77 ./ ((0.13 * (exp((-(v + 10.66)) / 11.1) + 1.0)))) : (2.7 * exp(0.079 * v) + 310000.0 * exp(0.3485 * v))),
bj ~ ((v >= -40.0) ? ((0.6 * exp(0.057 * v)) ./ (exp((-0.1) * (v + 32)) + 1.0)) : ((0.02424 * exp((-0.01052) * v)) ./ (exp((-0.1378) * (v + 40.14)) + 1.0))),
dss_b ~ 1.0763 * exp((-1.007) * exp((-0.0829) * v)),
dti_develop ~ 1.354 + 0.0001 ./ (exp((-(v - 12.23)) / 0.2154) + exp((v - 167.4) / 15.89)),
dti_recover ~ 1.0 - 0.5 ./ (exp((v + 70.0) / 20.0) + 1.0),
fss ~ 1.0 ./ (exp((v + 19.58) / 3.696) + 1.0),
hLss ~ 1.0 ./ (exp((v + 87.61) / 7.488) + 1.0),
hLssp ~ 1.0 ./ (exp((v + 93.81) / 7.488) + 1.0),
hss ~ 1.0 ./ (exp((v + 71.55) / 7.43) + 1.0) .^ 2.0,
hssp ~ 1.0 ./ (exp(((v + 71.55) + 6.0) / 7.43) + 1.0) .^ 2.0,
iss ~ 1.0 ./ (exp((v + 43.94) / 5.711) + 1.0),
jcass ~ 1.0 ./ (exp((v + 18.08) / 2.7916) + 1.0),
jss ~ 1.0 ./ (exp((v + 71.55) / 7.43) + 1.0) .^ 2.0,
mLss ~ 1.0 ./ (exp((-(v + 42.85)) / 5.264) + 1.0),
mss ~ 1.0 ./ (exp((-(v + 56.86)) / 9.03) + 1.0) .^ 2.0,
ta ~ 1.0515 ./ (1.0 ./ ((1.2089 * (exp((-(v - 18.4099)) / 29.3814) + 1.0))) + 3.5 ./ (exp((v + 100.0) / 29.3814) + 1.0)),
taum ~ 0.06487 * exp(-((v - 4.823) / 51.12) .^ 2.0) + 0.1292 * exp(-((v + 45.79) / 15.54) .^ 2.0),
td ~ 0.6 + 1.0 ./ (exp((-0.05) * (v + 6.0)) + exp(0.09 * (v + 14.0))),
tfcaf ~ 7.0 + 1.0 ./ (0.04 * exp((-(v - 4.0)) / 7.0) + 0.04 * exp((v - 4.0) / 7.0)),
tfcas ~ 100.0 + 1.0 ./ (0.00012 * exp((-v) / 3.0) + 0.00012 * exp(v / 7.0)),
tff ~ 7.0 + 1.0 ./ (0.0045 * exp((-(v + 20.0)) / 10.0) + 0.0045 * exp((v + 20.0) / 10.0)),
tfs ~ 1000.0 + 1.0 ./ (3.5e-05 * exp((-(v + 5.0)) / 4.0) + 3.5e-05 * exp((v + 5.0) / 6.0)),
tiF_b ~ 4.562 + 1.0 ./ (0.3933 * exp((-(v + 100.0)) / 100.0) + 0.08004 * exp((v + 50.0) / 16.59)),
tiS_b ~ 23.62 + 1.0 ./ (0.001416 * exp((-(v + 96.52)) / 59.05) + 1.78e-08 * exp((v + 114.1) / 8.079)),
tmL ~ 0.06487 * exp(-((v - 4.823) / 51.12) .^ 2.0) + 0.1292 * exp(-((v + 45.79) / 15.54) .^ 2.0),
txs1 ~ 817.3 + 1.0 ./ (0.0002326 * exp((v + 48.28) / 17.8) + 0.001292 * exp((-(v + 210.0)) / 230.0)),
txs2 ~ 1.0 ./ (0.01 * exp((v - 50.0) / 20.0) + 0.0193 * exp((-(v + 66.54)) / 31.0)),
xkb ~ 1.0 ./ (exp((-(v - 10.8968)) / 23.9871) + 1.0),
xs1ss ~ 1.0 ./ (exp((-(v + 11.6)) / 8.932) + 1.0),
Afs ~ 1.0 - Aff,
Ageo ~ L_cell .* ((2.0 * 3.14) * rad_) + rad_ .* ((2.0 * 3.14) * rad_),
vcell ~ L_cell .* (rad_ .* ((3.14 * 1000.0) * rad_)),
Cai ~ cai,
KsCa ~ 1.0 + 0.6 ./ ((3.8e-05 ./ cai) .^ 1.4 + 1.0),
Bcajsr ~ 1.0 ./ ((csqnmax .* kmcsqn) ./ (cajsr + kmcsqn) .^ 2.0 + 1.0),
Bcass ~ 1.0 ./ ((BSLmax .* KmBSL) ./ (KmBSL + cass) .^ 2.0 + ((BSRmax .* KmBSR) ./ (KmBSR + cass) .^ 2.0 + 1.0)),
CaMKb ~ (CaMKo .* (1.0 - CaMKt)) ./ (KmCaM ./ cass + 1.0),
CoA_KSLeq ~ CoA ./ KSLeq,
RT_over_F ~ (R .* T) ./ F,
frt ~ F ./ ((R .* T)),
vffrt ~ (F .* (F .* v)) ./ ((R .* T)),
vfrt ~ (F .* v) ./ ((R .* T)),
ECl ~ ((R .* T) ./ ((F .* zcl))) .* log(clo ./ cli),
EK ~ ((R .* T) ./ ((F .* zk))) .* log(ko ./ ki),
EKs ~ ((R .* T) ./ ((F .* zk))) .* log((PKNa .* nao + ko) ./ (PKNa .* nai + ki)),
Ii_i ~ (0.5 * (4.0 * cai + (cli + (ki + nai)))) / 1000.0,
Nai ~ nai,
ENa ~ ((R .* T) ./ ((F .* zna))) .* log(nao ./ nai),
Fh_MDH ~ (1.0 ./ ((1.0 + Kh3 ./ H_mito) + (Kh3 .* Kh4) ./ H_mito .^ 2.0)) .^ 2.0 .* (Koff + 1.0 ./ (H_mito .^ 2.0 ./ ((Kh1 .* Kh2)) + (H_mito ./ Kh1 + 1.0))),
GClB ~ GClB_b .* IClb_Multiplier,
GClCa ~ GClCa_b .* ICaCl_Multiplier,
GK1 ~ IK1_Multiplier .* ((celltype == 1.0) ? (1.2 * GK1_b) : (((celltype == 2.0) ? (1.3 * GK1_b) : (GK1_b)))),
delta_epi ~ ((celltype == 1.0) ? (1.0 - 0.95 ./ (exp((v + 70.0) / 5.0) + 1.0)) : (1.0)),
GKb ~ IKb_Multiplier .* ((celltype == 1.0) ? (0.6 * GKb_b) : (GKb_b)),
GKr ~ (IKr_Multiplier .* (0.4472135954999579 * sqrt(ko))) .* ((celltype == 1.0) ? (1.3 * GKr_b) : (((celltype == 2.0) ? (0.8 * GKr_b) : (GKr_b)))),
GKs ~ IKs_Multiplier .* ((celltype == 1.0) ? (1.4 * GKs_b) : (GKs_b)),
GNaL ~ INaL_Multiplier .* ((celltype == 1.0) ? (0.6 * GNaL_b) : (GNaL_b)),
Gncx ~ INaCa_Multiplier .* ((celltype == 1.0) ? (1.1 * Gncx_b) : (((celltype == 2.0) ? (1.4 * Gncx_b) : (Gncx_b)))),
GpCa ~ GpCa_b .* IpCa_Multiplier,
Gto ~ Ito_Multiplier .* ((celltype == 1.0 || celltype == 2.0) ? (2.0 * Gto_b) : (Gto_b)),
km2n ~ 1.0 * jca,
Io_i ~ (0.5 * (4.0 * cao + (clo + (ko + nao)))) / 1000.0,
Io_ss ~ (0.5 * (4.0 * cao + (clo + (ko + nao)))) / 1000.0,
Ii_ss ~ (0.5 * (4.0 * cass + (cli + (kss + nass)))) / 1000.0,
Istim ~ ((i_Stim_PulseDuration >= t + ((-i_Stim_Period) .* floor((-(i_Stim_Start - t)) ./ i_Stim_Period) - i_Stim_Start) && i_Stim_Start <= t) ? (i_Stim_Amplitude) : (0.0)),
Jdiff ~ (-cai + cass) ./ tauCa,
JdiffK ~ (-ki + kss) ./ tauK,
JdiffNa ~ (-nai + nass) ./ tauNa,
Jupnp_b ~ (cai .* (0.005425 * Jup_Multiplier)) ./ (cai + 0.00092),
Jupp_b ~ (cai .* (0.005425 * (2.75 * Jup_Multiplier))) ./ ((cai + 0.00092) - 0.00017),
Jleak ~ (cansr .* (0.0048825 * Jup_Multiplier)) / 15.0,
Jtr ~ (-cajsr + cansr) / 60.0,
KmATP_AM_Ki_AM ~ KmATP_AM ./ Ki_AM,
KmKGNAD_KmIDNAD ~ KmKGNAD ./ KmIDNAD,
KmSucc_KiFUM ~ KmSucc ./ KiFUM,
Kmal_Kioaa ~ Kmal ./ Kioaa,
Knai ~ Knai0 .* exp((F .* (delta .* v)) ./ (((3.0 * R) .* T))),
Knao ~ Knao0 .* exp((F .* (v .* (1.0 - delta))) ./ (((3.0 * R) .* T))),
Ktrop_Ca ~ kltrpn_minus ./ kltrpn_plus,
Ntrop ~ 3.5 * SL - 2.0,
mod_factor ~ (2.3 - SL) / (2.3 - 1.7) ^ 1.6 + 1.0,
Lm ~ -Lb + Lm_prime,
Mg_Kmg_1 ~ 1.0 + Mg ./ Kmg,
N0 ~ 1.0 - (P3 + (P2 + (P1 + (N1 + P0)))),
P1_N1_P2_P3 ~ P3 + (P2 + (N1 + P1)),
NAD ~ CPN - NADH,
P ~ eP ./ (((H ./ Khp + 1.0) + nai ./ Knap) + ki ./ Kxkur),
PCa ~ ICaL_Multiplier .* ((celltype == 1.0) ? (1.2 * PCa_b) : (((celltype == 2.0) ? (2.0 * PCa_b) : (PCa_b)))),
PCab_1 ~ ICab_Multiplier .* PCab,
PNab_1 ~ INab_Multiplier .* PNab,
Pnak ~ INaK_Multiplier .* ((celltype == 1.0) ? (0.9 * Pnak_b) : (((celltype == 2.0) ? (0.7 * Pnak_b) : (Pnak_b)))),
VAAT_Constant ~ (KAATeq .* (kcnsASP .* (GLU .* kfAAT))) ./ kfAAT,
kcnsASP_KAATeq_kfAAT ~ (KAATeq .* kcnsASP) ./ kfAAT,
pa_300 ~ 300.0 * pa,
VCS_C1 ~ (AcCoA .* (EtCS .* KCS)) ./ (AcCoA + KmAcCoA),
VIDH_Constant ~ (H_mito ./ kh_1 + 1.0) + kh_2 ./ H_mito,
VmDT_20 ~ 20.0 * VmDT,
VmDT_75 ~ 0.75 * VmDT,
inv_ktrans ~ 1.0 ./ ktrans,
Vmuni_ktrans ~ Vmuni ./ ktrans,
Vt_CRP2 ~ kt_2 .* (-CrPi_cyto + CrPi_mito),
a2 ~ k2p,
a4 ~ ((MgATP .* k4p) ./ Kmgatp) ./ (1.0 + MgATP ./ Kmgatp),
a_rel ~ 0.5 * bt,
btp ~ 1.25 * bt,
tau_rel_b ~ bt ./ (1.0 + 0.0123 ./ cajsr),
allo_i ~ 1.0 ./ ((KmCaAct ./ cai) .^ 2.0 + 1.0),
allo_ss ~ 1.0 ./ ((KmCaAct ./ cass) .^ 2.0 + 1.0),
b1 ~ MgADP .* k1m,
b_05 ~ 0.5 * b,
two_b ~ 2.0 * b,
cmdnmax ~ ((celltype == 1.0) ? (1.3 * cmdnmax_b) : (cmdnmax_b)),
constA ~ 1820000.0 * (T .* dielConstant) .^ (-1.5),
f_01 ~ 3.0 * f_xb,
f_12 ~ 10.0 * f_xb,
f_23 ~ 7.0 * f_xb,
g0_01 ~ 1.0 * gmin_xb,
g0_12 ~ 2.0 * gmin_xb,
g0_23 ~ 3.0 * gmin_xb,
h10_i ~ (nao ./ kna1) .* (1.0 + nao ./ kna2) + (kasymm + 1.0),
h10_ss ~ (nao ./ kna1) .* (1.0 + nao ./ kna2) + (kasymm + 1.0),
h4_i ~ (nai ./ kna1) .* (1.0 + nai ./ kna2) + 1.0,
h4_ss ~ (nass ./ kna1) .* (1.0 + nass ./ kna2) + 1.0,
hca ~ exp((F .* (qca .* v)) ./ ((R .* T))),
hna ~ exp((F .* (qna .* v)) ./ ((R .* T))),
inv_Cmito ~ 1.0 ./ Cmito,
inv_KADP ~ 1.0 ./ KADP,
inv_KaCa ~ 1.0 ./ KaCa,
inv_KiOxaa ~ 1.0 ./ KiOxaa,
inv_KidhNADH ~ 1.0 ./ KidhNADH,
inv_kact ~ 1.0 ./ kact,
inv_keq ~ 1.0 ./ keq,
k2_i ~ kcaoff,
k2_ss ~ kcaoff,
k5_i ~ kcaoff,
k5_ss ~ kcaoff,
kIDH_EtID ~ EtID .* kIDH,
kKGDH_EtKG ~ EtKG .* kKGDH,
kMDH_EtMD ~ EtMD .* kMDH,
kSDH_EtSDH ~ EtSDH .* kSDH,
kf1_Pi ~ kf1 ./ Pi,
kfFH_KFHeq ~ kfFH ./ KFHeq,
kres_sq_KmIDNAD ~ (kres .* kres) ./ KmIDNAD,
nca ~ nca_ss,
one_inv_KACOeq ~ 1.0 + 1.0 ./ KACOeq,
pb_pa_3 ~ 3.0 * (pa + pb),
rhoREF_ra ~ ra .* (4.0 * rhoREF),
ra_rb ~ 4.0 * (ra + rb),
rhoREF_ra_rb ~ (4.0 * rhoREF) .* (ra + rb),
rhoREN_ra ~ ra .* (0.5 * rhoREN),
rhoRen_6_ra ~ ra .* (6.0 * rhoREN),
rhoRen_6_ra_rb ~ (6.0 * rhoREN) .* (ra + rb),
rhoREN_rc2 ~ rc2 .* (0.5 * rhoREN),
thLp ~ 3.0 * thL,
ATPi_ADP ~ ATPi ./ ADP,
fNaK_ATP ~ 1.0 ./ ((K1ATP_NaK ./ ATPi) .* (ADP ./ KiADP_NaK + 1.0) + 1.0),
fpCa_ATP ~ 1.0 ./ ((K_m1pCa ./ ATPi) .* (ADP ./ K_ipCa + 1.0) + 1.0) + 1.0 ./ (1.0 + K_m2pCa ./ ATPi),
fserca_ATP ~ 1.0 ./ ((Kmup ./ ATPi) .* (ADP ./ Kiup + 1.0) + (ADP ./ Kiprime_up + 1.0)),
ADPm_ATPm ~ ADPm ./ ATPm,
Afcas ~ 1.0 - Afcaf,
AiS ~ 1.0 - AiF,
tauh ~ 1.0 ./ (ah + bh),
tauj ~ 1.0 ./ (aj + bj),
dss ~ ((v > 31.4978) ? (1.0) : (dss_b)),
fcass ~ fss,
tfcafp ~ 2.5 * tfcaf,
tffp ~ 2.5 * tff,
xs2ss ~ xs1ss,
f ~ Aff .* ff_ + Afs .* fs,
fp ~ Aff .* ffp + Afs .* fs,
Acap ~ 2.0 * Ageo,
vjsr ~ 0.0048 * vcell,
vmyo ~ 0.68 * vcell,
vnsr ~ 0.0552 * vcell,
vss ~ 0.02 * vcell,
CaMKa ~ CaMKb + CaMKt,
VSL ~ kfSL .* (ADPm .* SCoA - ATPm .* CoA_KSLeq .* Succ),
AREF ~ RT_over_F .* log(kresf .* sqrt(FADH2 ./ FAD)),
DmuH_Constant ~ DpH .* ((-2.303) * RT_over_F),
F_over_RT ~ 1.0 ./ RT_over_F,
alpha ~ 0.1161 * exp(0.299 * vfrt),
alpha2 ~ 0.0578 * exp(0.971 * vfrt),
alphac2ToI ~ 5.2e-05 * exp(1.525 * vfrt),
alphai ~ 0.2533 * exp(0.5953 * vfrt),
beta2 ~ 0.000349 * exp((-1.062) * vfrt),
beta_ ~ 0.2442 * exp((-1.604) * vfrt),
betai ~ (0.0522 * 1.25) * exp((-0.8209) * vfrt),
aK1 ~ 4.094 ./ (exp(0.1217 * ((-EK + v) - 49.934)) + 1.0),
bK1 ~ (15.72 * exp(0.0674 * ((-EK + v) - 3.257)) + exp(0.0618 * ((-EK + v) - 594.31))) ./ (exp((-0.1629) * ((-EK + v) + 14.207)) + 1.0),
I_Clbk ~ GClB .* (-ECl + v),
I_ClCa_junc ~ ((Fjunc .* GClCa) ./ (KdClCa ./ cass + 1.0)) .* (-ECl + v),
I_ClCa_sl ~ ((GClCa .* (1.0 - Fjunc)) ./ (KdClCa ./ cai + 1.0)) .* (-ECl + v),
tiF ~ delta_epi .* tiF_b,
tiS ~ delta_epi .* tiS_b,
IKb_IKb ~ (GKb .* xkb) .* (-EK + v),
IKr_IKr ~ (GKr .* O_) .* (-EK + v),
IKs_IKs ~ (xs2 .* (xs1 .* (GKs .* KsCa))) .* (-EKs + v),
IpCa_base ~ (GpCa .* cai) ./ (KmCap + cai),
anca ~ 1.0 ./ (k2n ./ km2n + (Kmn ./ cass + 1.0) .^ 4.0),
anca_i ~ 1.0 ./ (k2n ./ km2n + (Kmn ./ cai + 1.0) .^ 4.0),
Jupnp ~ ((celltype == 1.0) ? (1.3 * Jupnp_b) : (Jupnp_b)),
Jupp ~ ((celltype == 1.0) ? (1.3 * Jupp_b) : (Jupp_b)),
a1 ~ (k1p .* (nai ./ Knai) .^ 3.0) ./ (((1.0 + ki ./ Kki) .^ 2.0 + (1.0 + nai ./ Knai) .^ 3.0) - 1.0),
b4 ~ (k4m .* (ki ./ Kki) .^ 2.0) ./ (((1.0 + ki ./ Kki) .^ 2.0 + (1.0 + nai ./ Knai) .^ 3.0) - 1.0),
a3 ~ (k3p .* (ko ./ Kko) .^ 2.0) ./ (((1.0 + ko ./ Kko) .^ 2.0 + (1.0 + nao ./ Knao) .^ 3.0) - 1.0),
b2 ~ (k2m .* (nao ./ Knao) .^ 3.0) ./ (((1.0 + ko ./ Kko) .^ 2.0 + (1.0 + nao ./ Knao) .^ 3.0) - 1.0),
Ktrop_half_denom ~ Ktrop_Ca ./ (((-1.7 / 1000.0 + 0.9 / 1000.0) / (2.3 - 1.7)) * (SL - 1.7) + 1.7 / 1000.0) + 1.0,
g_01_mod ~ gmin_xb .* mod_factor,
g_01_off_mod ~ g_01_off .* mod_factor,
alpha_SL_1 ~ (-Lz + (Lm_prime + (-2.0 * La + SL))) ./ Lm,
alpha_SL_b ~ 1.0 - (SL - 2.2) ./ Lm,
Mg_Kmg_1_Kca ~ Mg_Kmg_1 ./ Kca,
KmIDNAD_NAD ~ KmIDNAD ./ NAD,
b3 ~ (H .* (P .* k3m)) ./ (1.0 + MgATP ./ Kmgatp),
PCaK ~ 0.0003574 * PCa,
PCaNa ~ 0.00125 * PCa,
PCap ~ 1.1 * PCa,
INab_INab ~ ((PNab_1 .* vffrt) .* (nai .* exp(vfrt) - nao)) ./ (exp(vfrt) - 1.0),
VAAT ~ (Oaa .* VAAT_Constant) ./ (AKG + kcnsASP_KAATeq_kfAAT),
VCS ~ (Oaa .* VCS_C1) ./ (KmOaa + Oaa),
Cai_ktrans_plus1 ~ Cai .* inv_ktrans + 1.0,
a_relp ~ 0.5 * btp,
tau_relp_b ~ btp ./ (1.0 + 0.0123 ./ cajsr),
tau_rel ~ ((tau_rel_b < 0.001) ? (0.001) : (tau_rel_b)),
Bcai ~ 1.0 ./ ((kmtrpn .* trpnmax) ./ (cai + kmtrpn) .^ 2.0 + ((cmdnmax .* kmcmdn) ./ (cai + kmcmdn) .^ 2.0 + 1.0)),
gamma_cai_i ~ exp((4.0 * (-constA)) .* (sqrt(Ii_i) ./ (sqrt(Ii_i) + 1.0) - 0.3 * Ii_i)),
gamma_cai_ss ~ exp((4.0 * (-constA)) .* (sqrt(Ii_ss) ./ (sqrt(Ii_ss) + 1.0) - 0.3 * Ii_ss)),
gamma_cao_i ~ exp((4.0 * (-constA)) .* (sqrt(Io_i) ./ (sqrt(Io_i) + 1.0) - 0.3 * Io_i)),
gamma_cao_ss ~ exp((4.0 * (-constA)) .* (sqrt(Io_ss) ./ (sqrt(Io_ss) + 1.0) - 0.3 * Io_ss)),
gamma_kao_i ~ exp((1.0 * (-constA)) .* (sqrt(Io_i) ./ (sqrt(Io_i) + 1.0) - 0.3 * Io_i)),
gamma_kao_ss ~ exp((1.0 * (-constA)) .* (sqrt(Io_ss) ./ (sqrt(Io_ss) + 1.0) - 0.3 * Io_ss)),
gamma_ki_i ~ exp((1.0 * (-constA)) .* (sqrt(Ii_i) ./ (sqrt(Ii_i) + 1.0) - 0.3 * Ii_i)),
gamma_ki_ss ~ exp((1.0 * (-constA)) .* (sqrt(Ii_ss) ./ (sqrt(Ii_ss) + 1.0) - 0.3 * Ii_ss)),
gamma_nai_i ~ exp((1.0 * (-constA)) .* (sqrt(Ii_i) ./ (sqrt(Ii_i) + 1.0) - 0.3 * Ii_i)),
gamma_nai_ss ~ exp((1.0 * (-constA)) .* (sqrt(Ii_ss) ./ (sqrt(Ii_ss) + 1.0) - 0.3 * Ii_ss)),
gamma_nao_i ~ exp((1.0 * (-constA)) .* (sqrt(Io_i) ./ (sqrt(Io_i) + 1.0) - 0.3 * Io_i)),
gamma_nao_ss ~ exp((1.0 * (-constA)) .* (sqrt(Io_ss) ./ (sqrt(Io_ss) + 1.0) - 0.3 * Io_ss)),
kTrop_pn_f_01 ~ -f_01 - kTrop_pn,
V_AM_scaler_max_1_f_01_12_23 ~ (V_AM_max .* V_AM_scaler) ./ (f_23 + (f_01 + f_12)),
g_12_mod ~ g0_12 .* mod_factor,
g_23_mod ~ g0_23 .* mod_factor,
paths ~ f_23 .* (f_01 .* f_12) + (g0_23 .* (f_01 .* f_12) + (g0_23 .* (f_01 .* g0_12) + g0_23 .* (g0_01 .* g0_12))),
h11_i ~ (nao .* nao) ./ ((kna2 .* (h10_i .* kna1))),
h12_i ~ 1.0 ./ h10_i,
h11_ss ~ (nao .* nao) ./ ((kna2 .* (h10_ss .* kna1))),
h12_ss ~ 1.0 ./ h10_ss,
h5_i ~ (nai .* nai) ./ ((kna2 .* (h4_i .* kna1))),
h6_i ~ 1.0 ./ h4_i,
h5_ss ~ (nass .* nass) ./ ((kna2 .* (h4_ss .* kna1))),
h6_ss ~ 1.0 ./ h4_ss,
h1_i ~ (nai ./ kna3) .* (hna + 1.0) + 1.0,
h1_ss ~ (nass ./ kna3) .* (hna + 1.0) + 1.0,
h7_i ~ (nao ./ kna3) .* (1.0 + 1.0 ./ hna) + 1.0,
h7_ss ~ (nao ./ kna3) .* (1.0 + 1.0 ./ hna) + 1.0,
Fa ~ 1.0 ./ (((ADPm .* inv_KADP + 1.0) .* (Cam .* inv_KaCa + 1.0))),
Fi ~ NADH .* inv_KidhNADH + 1.0,
VCK_cyto ~ kf_2 .* (ATPi_cyto .* (CRT_cyto - CrPi_cyto) - inv_keq .* CrPi_cyto .* (8.0 - ATPi_cyto)),
VCK_mito ~ kf_3 .* (ATPi .* (CRT_mito - CrPi_mito) - inv_keq .* ADP .* CrPi_mito),
kMDH_Fh_EtMD ~ Fh_MDH .* kMDH_EtMD,
VSDH ~ (Succ .* kSDH_EtSDH) ./ (Succ + (FUM .* KmSucc_KiFUM + KmSucc) .* (Oaa .* inv_KiOxaa + 1.0)),
AF1 ~ (ATPm .* kf1_Pi) ./ ADPm,
VFH ~ FUM .* kfFH - MAL .* kfFH_KFHeq,
VACO ~ kfACO .* (-ISOC .* one_inv_KACOeq + (CIK - (Oaa + (MAL + (FUM + (Succ + (AKG + SCoA))))))),
fca ~ Afcaf .* fcaf + Afcas .* fcas,
fcap ~ Afcaf .* fcafp + Afcas .* fcas,
i ~ AiF .* iF + AiS .* iS,
ip ~ AiF .* iFp + AiS .* iSp,
taujp ~ 1.46 * tauj,
fICaLp ~ 1.0 ./ (1.0 + KmCaMK ./ CaMKa),
fINaLp ~ 1.0 ./ (1.0 + KmCaMK ./ CaMKa),
fINap ~ 1.0 ./ (1.0 + KmCaMK ./ CaMKa),
fItop ~ 1.0 ./ (1.0 + KmCaMK ./ CaMKa),
fJrelp ~ 1.0 ./ (1.0 + KmCaMK ./ CaMKa),
fJupp ~ 1.0 ./ (1.0 + KmCaMK ./ CaMKa),
DmuH ~ DmuH_Constant + Dpsi,
FRT2 ~ 2.0 * F_over_RT,
FRT_3 ~ 3.0 * F_over_RT,
FRT_6_g ~ F_over_RT .* (6.0 * g),
exp_3_FRT_Dpsio ~ exp((3.0 * Dpsio) .* F_over_RT),
exp_6_FRT_Dpsio ~ exp((6.0 * Dpsio) .* F_over_RT),
exp_AREF_FRT ~ exp(AREF .* F_over_RT),
hm_F_over_RT ~ F_over_RT .* hm,
betaItoC2 ~ (alphac2ToI .* (beta2 .* betai)) ./ ((alpha2 .* alphai)),
K1ss ~ aK1 ./ (aK1 + bK1),
I_ClCa ~ I_ClCa_junc + I_ClCa_sl,
tiFp ~ tiF .* (dti_develop .* dti_recover),
tiSp ~ tiS .* (dti_develop .* dti_recover),
IpCa_IpCa ~ IpCa_base .* fpCa_ATP,
x2 ~ b4 .* (a2 .* a3) + (b4 .* (a3 .* b1) + (a3 .* (a1 .* a2) + b4 .* (b1 .* b2))),
Ktrop_half ~ 1.0 ./ Ktrop_half_denom,
kTrop_pn_f_12_g_01_mod ~ -(g_01_mod + (f_12 + kTrop_pn)),
alpha_SL_a ~ ((alpha_SL_1 < 1.0) ? (alpha_SL_1) : (1.0)),
a_kgdh ~ Cam .* Mg_Kmg_1_Kca + Mg_Kmg_1,
AREN ~ sqrt(KmIDNAD_NAD .* NADH .* kres_sq_KmIDNAD),
x1 ~ a2 .* (a1 .* b3) + (b3 .* (a2 .* b4) + (a2 .* (a1 .* a4) + b3 .* (b2 .* b4))),
x3 ~ b1 .* (a3 .* a4) + (a4 .* (b1 .* b2) + (a4 .* (a2 .* a3) + b1 .* (b2 .* b3))),
x4 ~ a1 .* (b2 .* b3) + (a1 .* (a4 .* b2) + (a1 .* (a3 .* a4) + b2 .* (b3 .* b4))),
PCaKp ~ 0.0003574 * PCap,
PCaNap ~ 0.00125 * PCap,
Cai_ktrans_plus1_p3 ~ Cai_ktrans_plus1 .^ 3.0,
tau_relp ~ ((tau_relp_b < 0.001) ? (0.001) : (tau_relp_b)),
gammaCaiMyo ~ gamma_cai_i,
PhiCaL_i ~ ((4.0 * vffrt) .* (-cao .* gamma_cao_i + (cai .* gamma_cai_i) .* exp(2.0 * vfrt))) ./ (exp(2.0 * vfrt) - 1.0),
gammaCaoMyo ~ gamma_cao_i,
PhiCaL_ss ~ ((4.0 * vffrt) .* (-cao .* gamma_cao_ss + (cass .* gamma_cai_ss) .* exp(2.0 * vfrt))) ./ (exp(2.0 * vfrt) - 1.0),
PhiCaK_i ~ ((1.0 * vffrt) .* (-gamma_kao_i .* ko + (gamma_ki_i .* ki) .* exp(1.0 * vfrt))) ./ (exp(1.0 * vfrt) - 1.0),
PhiCaK_ss ~ ((1.0 * vffrt) .* (-gamma_kao_ss .* ko + (gamma_ki_ss .* kss) .* exp(1.0 * vfrt))) ./ (exp(1.0 * vfrt) - 1.0),
PhiCaNa_i ~ ((1.0 * vffrt) .* (-gamma_nao_i .* nao + (gamma_nai_i .* nai) .* exp(1.0 * vfrt))) ./ (exp(1.0 * vfrt) - 1.0),
PhiCaNa_ss ~ ((1.0 * vffrt) .* (-gamma_nao_ss .* nao + (gamma_nai_ss .* nass) .* exp(1.0 * vfrt))) ./ (exp(1.0 * vfrt) - 1.0),
V_AM ~ (V_AM_scaler_max_1_f_01_12_23 .* (P2 .* f_23 + (P0 .* f_01 + P1 .* f_12))) ./ (inv_ATPi .* (ADP .* KmATP_AM_Ki_AM + KmATP_AM) + 1.0),
f_23_g_12_mod ~ -(f_23 + g_12_mod),
P1max ~ (g0_23 .* (f_01 .* g0_12)) ./ paths,
P2max ~ (g0_23 .* (f_01 .* f_12)) ./ paths,
P3max ~ (f_23 .* (f_01 .* f_12)) ./ paths,
k1_i ~ kcaon .* (cao .* h12_i),
k1_ss ~ kcaon .* (cao .* h12_ss),
k6_i ~ kcaon .* (cai .* h6_i),
k6_ss ~ kcaon .* (cass .* h6_ss),
h2_i ~ (hna .* nai) ./ ((h1_i .* kna3)),
h3_i ~ 1.0 ./ h1_i,
h2_ss ~ (hna .* nass) ./ ((h1_ss .* kna3)),
h3_ss ~ 1.0 ./ h1_ss,
h8_i ~ nao ./ ((h7_i .* (hna .* kna3))),
h9_i ~ 1.0 ./ h7_i,
h8_ss ~ nao ./ ((h7_ss .* (hna .* kna3))),
h9_ss ~ 1.0 ./ h7_ss,
VIDH ~ kIDH_EtID ./ ((Fa .* (Kmiso ./ ISOC) .^ nID) .* (Fi .* KmIDNAD_NAD + 1.0) + (Fi .* KmIDNAD_NAD + VIDH_Constant)),
VMDH ~ (NAD .* (MAL .* kMDH_Fh_EtMD)) ./ (((KmmNAD + NAD) .* (Kmal_Kioaa .* Oaa + (Kmal + MAL)))),
p2_p3_AF1 ~ AF1 .* p3 + p2,
INaL_INaL ~ (mL .* (GNaL .* (-ENa + v))) .* (fINaLp .* hLp + hL .* (1.0 - fINaLp)),
INa_INa ~ (m .^ 3.0 .* ((GNa .* INa_Multiplier) .* (-ENa + v))) .* (j .* (h .* (1.0 - fINap)) + jp .* (fINap .* hp)),
Ito_Ito ~ (Gto .* (-EK + v)) .* (i .* (a .* (1.0 - fItop)) + ip .* (ap .* fItop)),
Jrel ~ (Jrel_Multiplier .* Jrel_b) .* (Jrel_np .* (1.0 - fJrelp) + Jrel_p .* fJrelp),
Jup_base ~ -Jleak + (Jupnp .* (1.0 - fJupp) + Jupp .* fJupp),
Vhleak ~ DmuH .* gh,
FRT2_Dpsi ~ FRT2 .* (Dpsi - 91.0),
exp_3FRT_DmuH ~ exp(DmuH .* FRT_3),
exp_FRT_6_g_DmuH ~ exp(DmuH .* FRT_6_g),
VATPase_C1 ~ exp_3_FRT_Dpsio .* pc1 + 100.0 * pa,
p1_exp_3_FRT_Dpsio ~ exp_3_FRT_Dpsio .* p1,
r1_exp_6_FRT_Dpsio ~ exp_6_FRT_Dpsio .* r1,
rc1_ra_exp_6_FRT_Dpsio ~ exp_6_FRT_Dpsio .* rc1 + ra,
VFO_VHFe_C1 ~ exp_6_FRT_Dpsio .* (exp_AREF_FRT .* r1 + 1.0),
r2_r3_exp_AREF_FRT ~ exp_AREF_FRT .* r3 + r2,
VANT ~ (VmDT_75 - ADPm_ATPm .* (ATPi_ADP .* VmDT_20) .* exp(Dpsi .* (-F_over_RT))) ./ (((18.0 * ADPm_ATPm + 1.0) .* ((ATPi_ADP .* tenDiv9) .* exp(Dpsi .* (-hm_F_over_RT)) + 1.0))),
IK1_IK1 ~ (K1ss .* (GK1 .* (0.4472135954999579 * sqrt(ko)))) .* (-EK + v),
inv_LTRPNtot_Ktrop_half ~ 1.0 ./ ((Ktrop_half .* LTRPNtot)),
alpha_SL ~ ((SL < 2.2) ? (alpha_SL_a) : (alpha_SL_b)),
VKGDH ~ (a_kgdh .* kKGDH_EtKG) ./ (KmIDNAD_NAD .* KmKGNAD_KmIDNAD + (a_kgdh + (KmKG ./ AKG) .^ nKG)),
r2_r3_AREN ~ AREN .* r3 + r2,
E1 ~ x1 ./ (x4 + (x3 + (x1 + x2))),
E2 ~ x2 ./ (x4 + (x3 + (x1 + x2))),
E3 ~ x3 ./ (x4 + (x3 + (x1 + x2))),
E4 ~ x4 ./ (x4 + (x3 + (x1 + x2))),
ICaL_i_CaMK ~ (d .* (PCap .* PhiCaL_i)) .* (fp .* (1.0 - nca_i) + nca_i .* (fcap .* jca)),
ICaL_i_NP ~ (d .* (PCa .* PhiCaL_i)) .* (f .* (1.0 - nca_i) + nca_i .* (fca .* jca)),
ICab_ICab ~ ((vffrt .* (4.0 * PCab_1)) .* (-cao .* gammaCaoMyo + (cai .* gammaCaiMyo) .* exp(2.0 * vfrt))) ./ (exp(2.0 * vfrt) - 1.0),
ICaL_ss_CaMK ~ (d .* (PCap .* PhiCaL_ss)) .* (fp .* (1.0 - nca) + nca .* (fcap .* jca)),
ICaL_ss_NP ~ (d .* (PCa .* PhiCaL_ss)) .* (f .* (1.0 - nca) + nca .* (fca .* jca)),
ICaK_i_CaMK ~ (d .* (PCaKp .* PhiCaK_i)) .* (fp .* (1.0 - nca_i) + nca_i .* (fcap .* jca)),
ICaK_i_NP ~ (d .* (PCaK .* PhiCaK_i)) .* (f .* (1.0 - nca_i) + nca_i .* (fca .* jca)),
ICaK_ss_CaMK ~ (d .* (PCaKp .* PhiCaK_ss)) .* (fp .* (1.0 - nca) + nca .* (fcap .* jca)),
ICaK_ss_NP ~ (d .* (PCaK .* PhiCaK_ss)) .* (f .* (1.0 - nca) + nca .* (fca .* jca)),
ICaNa_i_CaMK ~ (d .* (PCaNap .* PhiCaNa_i)) .* (fp .* (1.0 - nca_i) + nca_i .* (fcap .* jca)),
ICaNa_i_NP ~ (d .* (PCaNa .* PhiCaNa_i)) .* (f .* (1.0 - nca_i) + nca_i .* (fca .* jca)),
ICaNa_ss_CaMK ~ (d .* (PCaNap .* PhiCaNa_ss)) .* (fp .* (1.0 - nca) + nca .* (fcap .* jca)),
ICaNa_ss_NP ~ (d .* (PCaNa .* PhiCaNa_ss)) .* (f .* (1.0 - nca) + nca .* (fca .* jca)),
Fmax ~ 3.0 * P3max + (P1max + 2.0 * P2max),
fnormmax2 ~ P3max + (P1max + P2max),
k4pp_i ~ h2_i .* wnaca,
k7_i ~ wna .* (h2_i .* h5_i),
k4p_i ~ (h3_i .* wca) ./ hca,
k4pp_ss ~ h2_ss .* wnaca,
k7_ss ~ wna .* (h2_ss .* h5_ss),
k4p_ss ~ (h3_ss .* wca) ./ hca,
k3pp_i ~ h8_i .* wnaca,
k8_i ~ wna .* (h11_i .* h8_i),
k3p_i ~ h9_i .* wca,
k3pp_ss ~ h8_ss .* wnaca,
k8_ss ~ wna .* (h11_ss .* h8_ss),
k3p_ss ~ h9_ss .* wca,
Jup_scaled ~ Jup_base .* fserca_ATP,
VnaCa ~ (Cam .* (VmNC .* exp(FRT2_Dpsi .* b_05))) ./ (((Cai .* (Kna ./ Nai + 1.0) .^ n) .* (1.0 + Knca ./ Cam))),
Vuni ~ (Cai_ktrans_plus1_p3 .* (FRT2_Dpsi .* (Cai .* Vmuni_ktrans))) ./ (((1.0 - exp(-FRT2_Dpsi)) .* (Cai_ktrans_plus1 .* Cai_ktrans_plus1_p3 + L ./ (Cai .* inv_kact + 1.0) .^ na))),
denominator_VATPase_Vhu ~ (-rhoF1) ./ (exp_3FRT_DmuH .* p2_p3_AF1 + (AF1 .* p1_exp_3_FRT_Dpsio + exp_3_FRT_Dpsio)),
rhoREN_rc1_ra_exp_6_FRT_Dpsio ~ rc1_ra_exp_6_FRT_Dpsio .* (0.5 * rhoREN),
denominator_VHFe ~ rhoREF ./ (VFO_VHFe_C1 + exp_FRT_6_g_DmuH .* r2_r3_exp_AREF_FRT),
kTrop_np ~ kTrop_pn .* (LTRPNCa .* inv_LTRPNtot_Ktrop_half) .^ Ntrop,
denominator_VHNe_VNo ~ 1.0 ./ (exp_FRT_6_g_DmuH .* r2_r3_AREN + (AREN .* r1_exp_6_FRT_Dpsio + exp_6_FRT_Dpsio)),
JnakNa ~ 3.0 * (E1 .* a3 - E2 .* b3),
JnakK ~ 2.0 * (-E3 .* a1 + E4 .* b1),
ICaL_i_b ~ ICaL_i_CaMK .* fICaLp + ICaL_i_NP .* (1.0 - fICaLp),
ICaL_ss_b ~ ICaL_ss_CaMK .* fICaLp + ICaL_ss_NP .* (1.0 - fICaLp),
ICaK_i_b ~ ICaK_i_CaMK .* fICaLp + ICaK_i_NP .* (1.0 - fICaLp),
ICaK_ss_b ~ ICaK_ss_CaMK .* fICaLp + ICaK_ss_NP .* (1.0 - fICaLp),
ICaNa_i_b ~ ICaNa_i_CaMK .* fICaLp + ICaNa_i_NP .* (1.0 - fICaLp),
ICaNa_ss_b ~ ICaNa_ss_CaMK .* fICaLp + ICaNa_ss_NP .* (1.0 - fICaLp),
fnormmax ~ Fmax / 3.0,
alpha_SL_fnormmax2 ~ alpha_SL ./ fnormmax2,
k4_i ~ k4p_i + k4pp_i,
k4_ss ~ k4p_ss + k4pp_ss,
k3_i ~ k3p_i + k3pp_i,
k3_ss ~ k3p_ss + k3pp_ss,
Jup ~ ((Jup_scaled < 0) ? (0.0) : (Jup_scaled)),
VATPase ~ denominator_VATPase_Vhu .* (AF1 .* (VATPase_C1 + exp_3FRT_DmuH .* pc2) - exp_3FRT_DmuH .* pa),
Vhu ~ denominator_VATPase_Vhu .* (-exp_3FRT_DmuH .* pb_pa_3 + (AF1 .* pa_300 + pa_300)),
VHFe ~ denominator_VHFe .* (exp_AREF_FRT .* rhoREF_ra - exp_FRT_6_g_DmuH .* rhoREF_ra_rb),
VHNe ~ denominator_VHNe_VNo .* (AREN .* rhoRen_6_ra - exp_FRT_6_g_DmuH .* rhoRen_6_ra_rb),
VNO ~ denominator_VHNe_VNo .* (AREN .* (exp_FRT_6_g_DmuH .* rhoREN_rc2 + rhoREN_rc1_ra_exp_6_FRT_Dpsio) - exp_FRT_6_g_DmuH .* rhoREN_ra),
INaK_base ~ Pnak .* (JnakK .* zk + JnakNa .* zna),
ICaL_i ~ ICaL_i_b .* (1.0 - ICaL_fractionSS),
ICaL_ss ~ ICaL_fractionSS .* ICaL_ss_b,
ICaK_i ~ ICaK_i_b .* (1.0 - ICaL_fractionSS),
ICaK_ss ~ ICaK_ss_b .* ICaL_fractionSS,
ICaNa_i ~ ICaNa_i_b .* (1.0 - ICaL_fractionSS),
ICaNa_ss ~ ICaL_fractionSS .* ICaNa_ss_b,
alpha_SL_fnormmax ~ (alpha_SL ./ fnormmax) / 3.0,
FN_Ca ~ P1_N1_P2_P3 .* alpha_SL_fnormmax2,
x2_i ~ (k1_i .* k7_i) .* (k4_i + k5_i) + (k4_i .* k6_i) .* (k1_i + k8_i),
x2_ss ~ (k1_ss .* k7_ss) .* (k4_ss + k5_ss) + (k4_ss .* k6_ss) .* (k1_ss + k8_ss),
x1_i ~ (k2_i .* k4_i) .* (k6_i + k7_i) + (k5_i .* k7_i) .* (k2_i + k3_i),
x3_i ~ (k1_i .* k3_i) .* (k6_i + k7_i) + (k6_i .* k8_i) .* (k2_i + k3_i),
x4_i ~ (k2_i .* k8_i) .* (k4_i + k5_i) + (k3_i .* k5_i) .* (k1_i + k8_i),
x1_ss ~ (k2_ss .* k4_ss) .* (k6_ss + k7_ss) + (k5_ss .* k7_ss) .* (k2_ss + k3_ss),
x3_ss ~ (k1_ss .* k3_ss) .* (k6_ss + k7_ss) + (k6_ss .* k8_ss) .* (k2_ss + k3_ss),
x4_ss ~ (k2_ss .* k8_ss) .* (k4_ss + k5_ss) + (k3_ss .* k5_ss) .* (k1_ss + k8_ss),
INaK_INaK ~ INaK_base .* fNaK_ATP,
ICaL_ICaL ~ ICaL_i + ICaL_ss,
Jrel_inf_b ~ ((-ICaL_ss) .* a_rel) ./ ((jsrMidpoint ./ cajsr) .^ 8.0 + 1.0),
Jrel_infp_b ~ ((-ICaL_ss) .* a_relp) ./ ((jsrMidpoint ./ cajsr) .^ 8.0 + 1.0),
ICaK ~ ICaK_i + ICaK_ss,
ICaNa ~ ICaNa_i + ICaNa_ss,
force_norm ~ alpha_SL_fnormmax .* (P3 + (P3 + (P1_N1_P2_P3 + P2))),
zeta_alpha_SL_fnormmax ~ alpha_SL_fnormmax .* zeta,
E1_i ~ x1_i ./ (x4_i + (x3_i + (x1_i + x2_i))),
E2_i ~ x2_i ./ (x4_i + (x3_i + (x1_i + x2_i))),
E3_i ~ x3_i ./ (x4_i + (x3_i + (x1_i + x2_i))),
E4_i ~ x4_i ./ (x4_i + (x3_i + (x1_i + x2_i))),
E1_ss ~ x1_ss ./ (x4_ss + (x3_ss + (x1_ss + x2_ss))),
E2_ss ~ x2_ss ./ (x4_ss + (x3_ss + (x1_ss + x2_ss))),
E3_ss ~ x3_ss ./ (x4_ss + (x3_ss + (x1_ss + x2_ss))),
E4_ss ~ x4_ss ./ (x4_ss + (x3_ss + (x1_ss + x2_ss))),
Jrel_inf ~ ((celltype == 2.0) ? (1.7 * Jrel_inf_b) : (Jrel_inf_b)),
Jrel_infp ~ ((celltype == 2.0) ? (1.7 * Jrel_infp_b) : (Jrel_infp_b)),
force ~ zeta_alpha_SL_fnormmax .* (P3 + (P3 + (P1_N1_P2_P3 + P2))),
JncxCa_i ~ -E1_i .* k1_i + E2_i .* k2_i,
JncxNa_i ~ -E2_i .* k3pp_i + (E3_i .* k4pp_i + 3.0 * (-E1_i .* k8_i + E4_i .* k7_i)),
JncxCa_ss ~ -E1_ss .* k1_ss + E2_ss .* k2_ss,
JncxNa_ss ~ -E2_ss .* k3pp_ss + (E3_ss .* k4pp_ss + 3.0 * (-E1_ss .* k8_ss + E4_ss .* k7_ss)),
INaCa_i ~ (allo_i .* (Gncx .* (1.0 - INaCa_fractionSS))) .* (JncxCa_i .* zca + JncxNa_i .* zna),
INaCa_ss ~ (allo_ss .* (Gncx .* INaCa_fractionSS)) .* (JncxCa_ss .* zca + JncxNa_ss .* zna)
    ]


    eqs = [
        D(hL) ~ (-hL + hLss) ./ thL,
D(jca) ~ (-jca + jcass) ./ tjca,
D(a) ~ (-a + ass) ./ ta,
D(ap) ~ (-ap + assp) ./ ta,
D(m) ~ (-m + mss) ./ taum,
D(ff_) ~ (-ff_ + fss) ./ tff,
D(fs) ~ (-fs + fss) ./ tfs,
D(mL) ~ (-mL + mLss) ./ tmL,
D(xs1) ~ (-xs1 + xs1ss) ./ txs1,
D(HTRPNCa) ~ -HTRPNCa .* khtrpn_minus + (Cai .* khtrpn_plus) .* (-HTRPNCa + HTRPNtot),
D(CaMKt) ~ -CaMKt .* bCaMK + (CaMKb .* aCaMK) .* (CaMKb + CaMKt),
D(hLp) ~ (-hLp + hLssp) ./ thLp,
D(h) ~ (-h + hss) ./ tauh,
D(hp) ~ (-hp + hssp) ./ tauh,
D(j) ~ (-j + jss) ./ tauj,
D(d) ~ (-d + dss) ./ td,
D(fcaf) ~ (-fcaf + fcass) ./ tfcaf,
D(fcas) ~ (-fcas + fcass) ./ tfcas,
D(fcafp) ~ (-fcafp + fcass) ./ tfcafp,
D(ffp) ~ (-ffp + fss) ./ tffp,
D(xs2) ~ (-xs2 + xs2ss) ./ txs2,
D(C0) ~ -C0 .* alpha + C1 .* beta_,
D(C1) ~ -C1 .* (alpha_1 + beta_) + (C0 .* alpha + C2 .* beta_1),
D(O_) ~ -O_ .* (alphai + beta2) + (C2 .* alpha2 + I_ .* betai),
D(iF) ~ (-iF + iss) ./ tiF,
D(iS) ~ (-iS + iss) ./ tiS,
D(nca_ss) ~ anca .* k2n - km2n .* nca_ss,
D(nca_i) ~ anca_i .* k2n - km2n .* nca_i,
D(ASP) ~ -ASP .* kcnsASP + VAAT,
D(P3) ~ P2 .* f_23 + P3 .* (-g_23_mod),
D(ATPi_cyto) ~ -VATPase_cyto - VCK_cyto,
D(CrPi_cyto) ~ VCK_cyto + Vt_CRP2,
D(CrPi_mito) ~ VCK_mito - Vt_CRP2,
D(Succ) ~ -VSDH + VSL,
D(FUM) ~ -VFH + VSDH,
D(jp) ~ (-jp + jss) ./ taujp,
D(C2) ~ -C2 .* (alphac2ToI + (alpha2 + beta_1)) + (I_ .* betaItoC2 + (C1 .* alpha_1 + O_ .* beta2)),
D(I_) ~ -I_ .* (betaItoC2 + betai) + (C2 .* alphac2ToI + O_ .* alphai),
D(iFp) ~ (-iFp + iss) ./ tiFp,
D(iSp) ~ (-iSp + iss) ./ tiSp,
D(P2) ~ P3 .* g_23_mod + (P1 .* f_12 + P2 .* f_23_g_12_mod),
D(ISOC) ~ VACO - VIDH,
D(MAL) ~ VFH - VMDH,
D(Oaa) ~ -VAAT + (-VCS + VMDH),
D(cajsr) ~ Bcajsr .* (-Jrel + Jtr),
D(AKG) ~ -VKGDH + (VAAT + VIDH),
D(SCoA) ~ VKGDH - VSL,
D(Cam) ~ fm .* (-VnaCa + Vuni),
D(N1) ~ -N1 .* (g_01_off_mod + kTrop_np) + P1 .* kTrop_pn,
D(P0) ~ P1 .* g_01_mod + (N0 .* kTrop_np + P0 .* kTrop_pn_f_01),
D(P1) ~ P2 .* g_12_mod + (P0 .* f_01 + (N1 .* kTrop_np + P1 .* kTrop_pn_f_12_g_01_mod)),
D(cansr) ~ Jup - Jtr .* vjsr ./ vnsr,
D(ADPm) ~ -VSL + (VANT - VATPase),
D(Dpsi) ~ inv_Cmito .* (-(2.0 * Vuni + (VnaCa .* two_b + (Vhleak + (VANT + (Vhu + (-VHFe - VHNe))))))),
D(NADH) ~ VMDH + (VKGDH + (VIDH - VNO)),
D(kss) ~ -JdiffK + (Acap .* (-ICaK_ss)) ./ ((F .* vss)),
D(LTRPNCa) ~ (Cai .* kltrpn_plus) .* (-LTRPNCa + LTRPNtot) - LTRPNCa .* kltrpn_minus .* (1.0 - FN_Ca .* twoThirds),
D(ATPi) ~ -VCK_mito + (-6.371e-05 * (INaK_INaK + IpCa_IpCa) + (-0.05 * Jup + (0.615 * VANT - V_AM))),
D(ki) ~ (Acap .* (-(-2.0 * INaK_INaK + (Istim + (IKb_IKb + (IK1_IK1 + (IKs_IKs + (IKr_IKr + (ICaK_i + Ito_Ito))))))))) ./ ((F .* vmyo)) + (JdiffK .* vss) ./ vmyo,
D(Jrel_np) ~ (Jrel_inf - Jrel_np) ./ tau_rel,
D(Jrel_p) ~ (Jrel_infp - Jrel_p) ./ tau_relp,
D(cai) ~ Bcai .* (((Acap .* (-(-2.0 * INaCa_i + (ICab_ICab + (ICaL_i + IpCa_IpCa))))) ./ (((2.0 * F) .* vmyo)) - Jup .* vnsr ./ vmyo) + (Jdiff .* vss) ./ vmyo),
D(nai) ~ (Acap .* (-(INab_INab + (3.0 * INaK_INaK + (3.0 * INaCa_i + (INaL_INaL + (ICaNa_i + INa_INa))))))) ./ ((F .* vmyo)) + (JdiffNa .* vss) ./ vmyo,
D(cass) ~ Bcass .* (-Jdiff + ((Acap .* (-(ICaL_ss - 2.0 * INaCa_ss))) ./ (((2.0 * F) .* vss)) + (Jrel .* vjsr) ./ vss)),
D(nass) ~ -JdiffNa + (Acap .* (-(ICaNa_ss + 3.0 * INaCa_ss))) ./ ((F .* vss)),
D(v) ~ -(Istim + (I_Clbk + (I_ClCa + (ICab_ICab + (IpCa_IpCa + (IKb_IKb + (INab_INab + (INaK_INaK + (INaCa_ss + (INaCa_i + (IK1_IK1 + (IKs_IKs + (IKr_IKr + (ICaK + (ICaNa + (ICaL_ICaL + (Ito_Ito + (INaL_INaL + INa_INa))))))))))))))))))
    ]


    defaults = Dict(
        hL => 0.5986118,
jca => 0.9999743,
a => 0.0007994042,
ap => 0.0004072777,
m => 0.0004619565,
ff_ => 1,
fs => 0.9183587,
mL => 9.987709e-05,
xs1 => 0.2642293,
HTRPNCa => 0.0,
CaMKt => 0.0201882,
hLp => 0.3339899,
h => 0.8739077,
hp => 0.7478972,
j => 0.8737841,
d => -8.334604e-30,
fcaf => 1,
fcas => 0.999754,
fcafp => 1,
ffp => 1,
xs2 => 0.0001327348,
C0 => 0.9983451,
C1 => 0.000708646,
O_ => 0.0003445733,
iF => 0.9997514,
iS => 0.5702538,
nca_ss => 0.000533652,
nca_i => 0.001257861,
ASP => 0.0,
P3 => 0.0,
ATPi_cyto => 0.0,
CrPi_cyto => 0.0,
CrPi_mito => 0.0,
Succ => 0.0,
FUM => 0.0,
jp => 0.8735375,
C2 => 0.0005910047,
I_ => 1.06423e-05,
iFp => 0.9997514,
iSp => 0.6351927,
P2 => 0.0,
ISOC => 0.0,
MAL => 0.0,
Oaa => 0.0,
cajsr => 2.016415,
AKG => 0.0,
SCoA => 0.0,
Cam => 0.0,
N1 => 0.0,
P0 => 0.0,
P1 => 0.0,
cansr => 2.012225,
ADPm => 0.0,
Dpsi => 0.0,
NADH => 0.0,
kss => 156.713,
LTRPNCa => 0.0,
ATPi => 8.0,
ki => 156.7131,
Jrel_np => -1.300486e-21,
Jrel_p => -7.610714e-20,
cai => 8.297576e-05,
nai => 15.94867,
cass => 6.642187e-05,
nass => 15.94922,
v => -91.33918,
AcCoA => 1.0,
Aff => 0.6,
BSLmax => 1.124,
BSRmax => 0.047,
CIK => 1,
CPN => 10,
CRT_cyto => 25,
CRT_mito => 25,
CaMKo => 0.05,
Cm => 1.5,
Cmito => 0.001812,
CoA => 0.02,
DpH => -0.6,
Dpsio => 50,
EtCS => 0.4,
EtID => 0.109,
EtKG => 0.5,
EtMD => 0.154,
EtSDH => 0.5,
F => 96485.0,
FAD => 0.01,
FADH2 => 1.24,
Fjunc => 1.0,
GClB_b => 0.00198,
GClCa_b => 0.2843,
GK1_b => 0.6992,
GKb_b => 0.0189,
GKr_b => 0.0321,
GKs_b => 0.0011,
GLU => 10,
GNa => 11.7802,
GNaL_b => 0.0279,
Gncx_b => 0.0034,
GpCa_b => 0.0005,
Gto_b => 0.16,
H => 1e-07,
HTRPNtot => 0.14,
H_mito => 2.5e-05,
ICaCl_Multiplier => 1.0,
ICaL_Multiplier => 1.0,
ICaL_fractionSS => 0.8,
ICab_Multiplier => 1.0,
IClb_Multiplier => 1.0,
IK1_Multiplier => 1.0,
IKb_Multiplier => 1.0,
IKr_Multiplier => 1.0,
IKs_Multiplier => 1.0,
INaCa_Multiplier => 1.0,
INaCa_fractionSS => 0.35,
INaK_Multiplier => 1.0,
INaL_Multiplier => 1.0,
INa_Multiplier => 1.0,
INab_Multiplier => 1.0,
IpCa_Multiplier => 1.0,
Ito_Multiplier => 1.0,
Jrel_Multiplier => 1.0,
Jrel_b => 1.5378,
Jup_Multiplier => 1.0,
K1ATP_NaK => 0.008,
KAATeq => 6.6,
KACOeq => 2.22,
KADP => 0.62,
KCS => 0.05,
KFHeq => 1,
KSLeq => 3.115,
K_ipCa => 1.0,
K_m1pCa => 0.012,
K_m2pCa => 0.23,
KaCa => 0.0005,
Kca => 0.00127,
KdClCa => 0.1,
Kh1 => 1.13e-05,
Kh2 => 26.7,
Kh3 => 6.68e-09,
Kh4 => 5.62e-06,
Khp => 1.698e-07,
KiADP_NaK => 0.1,
KiFUM => 1.3,
KiOxaa => 0.15,
Ki_AM => 0.26,
KidhNADH => 0.19,
Kioaa => 0.0031,
Kiprime_up => 5.1,
Kiup => 0.14,
Kki => 0.5,
Kko => 0.3582,
KmATP_AM => 0.03,
KmAcCoA => 0.0126,
KmBSL => 0.0087,
KmBSR => 0.00087,
KmCaAct => 0.00015,
KmCaM => 0.0015,
KmCaMK => 0.15,
KmCap => 0.0005,
KmIDNAD => 0.923,
KmKG => 1.94,
KmKGNAD => 38.7,
KmOaa => 0.00064,
KmSucc => 0.03,
Kmal => 1.493,
Kmg => 0.0308,
Kmgatp => 1.698e-07,
Kmiso => 1.52,
KmmNAD => 0.2244,
Kmn => 0.002,
Kmup => 0.01,
Kna => 9.4,
Knai0 => 9.073,
Knao0 => 27.78,
Knap => 224.0,
Knca => 0.000375,
Koff => 0.0399,
Kxkur => 292.0,
L => 110.0,
LTRPNtot => 0.07,
L_cell => 0.01,
La => 1,
Lb => 0.1,
Lm_prime => 1.5,
Lz => 0.1,
Mg => 0.4,
MgADP => 0.05,
MgATP => 9.8,
PCa_b => 8.3757e-05,
PCab => 5.9194e-08,
PKNa => 0.01833,
PNab => 1.9239e-09,
Pi => 2.0,
Pnak_b => 15.4509,
R => 8314.0,
SL => 2.15,
T => 310.0,
VATPase_cyto => 1e-05,
V_AM_max => 0.00048,
V_AM_scaler => 15,
VmDT => 0.015,
VmNC => 6.25e-05,
Vmuni => 0.0275,
aCaMK => 0.05,
alpha_1 => 0.154375,
b => 0.5,
bCaMK => 0.00068,
beta_1 => 0.1911,
bt => 4.75,
cao => 1.8,
celltype => 0.0,
clo => 150.0,
cmdnmax_b => 0.05,
csqnmax => 10.0,
delta => -0.155,
dielConstant => 74.0,
eP => 4.2,
f_xb => 0.05,
fm => 0.0003,
g => 0.85,
g_01_off => 0.03,
gh => 2e-07,
gmin_xb => 0.1,
hm => 0.5,
i_Stim_Amplitude => -53.0,
i_Stim_Period => 1000.0,
i_Stim_PulseDuration => 1.0,
i_Stim_Start => 0.0,
jsrMidpoint => 1.7,
k1m => 182.4,
k1p => 949.5,
k2m => 39.4,
k2n => 500.0,
k2p => 687.2,
k3m => 79300.0,
k3p => 1899.0,
k4m => 40.0,
k4p => 639.0,
kIDH => 0.05,
kKGDH => 0.075,
kMDH => 0.111,
kSDH => 0.005,
kTrop_pn => 0.04,
kact => 0.00038,
kasymm => 12.5,
kcaoff => 5000.0,
kcaon => 1500000.0,
kcnsASP => 1.5e-06,
keq => 0.0095,
kf1 => 1710000.0,
kfAAT => 0.000644,
kfACO => 0.0125,
kfFH => 0.00332,
kfSL => 0.005,
kf_2 => 0.00014,
kf_3 => 1.33e-06,
kh_1 => 8.1e-05,
kh_2 => 5.98e-05,
khtrpn_minus => 0.00033,
khtrpn_plus => 100,
kltrpn_minus => 0.04,
kltrpn_plus => 100,
kmcmdn => 0.00238,
kmcsqn => 0.8,
kmtrpn => 0.0005,
kna1 => 15.0,
kna2 => 5.0,
kna3 => 88.12,
ko => 5.0,
kres => 1.35e+18,
kresf => 57650000000000.0,
kt_2 => 0.002,
ktrans => 0.019,
n => 6,
nID => 2,
nKG => 1.2,
na => 2.8,
nao => 140.0,
p1 => 1.346e-08,
p2 => 7.739e-07,
p3 => 6.65e-15,
pa => 1.656e-08,
pb => 3.373e-10,
pc1 => 9.651e-17,
pc2 => 4.585e-17,
qca => 0.167,
qna => 0.5224,
r1 => 2.077e-18,
r2 => 1.728e-09,
r3 => 1.059e-26,
ra => 6.394e-13,
rad_ => 0.0011,
rb => 1.762e-16,
rc1 => 2.656e-22,
rc2 => 8.632e-30,
rhoF1 => 0.05,
rhoREF => 0.000375,
rhoREN => 0.101,
tauCa => 0.2,
tauK => 2.0,
tauNa => 2.0,
thL => 200.0,
tjca => 75.0,
trpnmax => 0.07,
wca => 60000.0,
wna => 60000.0,
wnaca => 5000.0,
zca => 2.0,
zcl => -1.0,
zeta => 0.1,
zk => 1.0,
zna => 1.0
    )


@named model_Torord_withmito = ODESystem(
    eqs,
    t,
    [hL, jca, a, ap, m, ff_, fs, mL, xs1, HTRPNCa, CaMKt, hLp, h, hp, j, d, fcaf, fcas, fcafp, ffp, xs2, C0, C1, O_, iF, iS, nca_ss, nca_i, ASP, P3, ATPi_cyto, CrPi_cyto, CrPi_mito, Succ, FUM, jp, C2, I_, iFp, iSp, P2, ISOC, MAL, Oaa, cajsr, AKG, SCoA, Cam, N1, P0, P1, cansr, ADPm, Dpsi, NADH, kss, LTRPNCa, ATPi, ki, Jrel_np, Jrel_p, cai, nai, cass, nass, v],
    [AcCoA, Aff, BSLmax, BSRmax, CIK, CPN, CRT_cyto, CRT_mito, CaMKo, Cm, Cmito, CoA, DpH, Dpsio, EtCS, EtID, EtKG, EtMD, EtSDH, F, FAD, FADH2, Fjunc, GClB_b, GClCa_b, GK1_b, GKb_b, GKr_b, GKs_b, GLU, GNa, GNaL_b, Gncx_b, GpCa_b, Gto_b, H, HTRPNtot, H_mito, ICaCl_Multiplier, ICaL_Multiplier, ICaL_fractionSS, ICab_Multiplier, IClb_Multiplier, IK1_Multiplier, IKb_Multiplier, IKr_Multiplier, IKs_Multiplier, INaCa_Multiplier, INaCa_fractionSS, INaK_Multiplier, INaL_Multiplier, INa_Multiplier, INab_Multiplier, IpCa_Multiplier, Ito_Multiplier, Jrel_Multiplier, Jrel_b, Jup_Multiplier, K1ATP_NaK, KAATeq, KACOeq, KADP, KCS, KFHeq, KSLeq, K_ipCa, K_m1pCa, K_m2pCa, KaCa, Kca, KdClCa, Kh1, Kh2, Kh3, Kh4, Khp, KiADP_NaK, KiFUM, KiOxaa, Ki_AM, KidhNADH, Kioaa, Kiprime_up, Kiup, Kki, Kko, KmATP_AM, KmAcCoA, KmBSL, KmBSR, KmCaAct, KmCaM, KmCaMK, KmCap, KmIDNAD, KmKG, KmKGNAD, KmOaa, KmSucc, Kmal, Kmg, Kmgatp, Kmiso, KmmNAD, Kmn, Kmup, Kna, Knai0, Knao0, Knap, Knca, Koff, Kxkur, L, LTRPNtot, L_cell, La, Lb, Lm_prime, Lz, Mg, MgADP, MgATP, PCa_b, PCab, PKNa, PNab, Pi, Pnak_b, R, SL, T, VATPase_cyto, V_AM_max, V_AM_scaler, VmDT, VmNC, Vmuni, aCaMK, alpha_1, b, bCaMK, beta_1, bt, cao, celltype, clo, cmdnmax_b, csqnmax, delta, dielConstant, eP, f_xb, fm, g, g_01_off, gh, gmin_xb, hm, i_Stim_Amplitude, i_Stim_Period, i_Stim_PulseDuration, i_Stim_Start, jsrMidpoint, k1m, k1p, k2m, k2n, k2p, k3m, k3p, k4m, k4p, kIDH, kKGDH, kMDH, kSDH, kTrop_pn, kact, kasymm, kcaoff, kcaon, kcnsASP, keq, kf1, kfAAT, kfACO, kfFH, kfSL, kf_2, kf_3, kh_1, kh_2, khtrpn_minus, khtrpn_plus, kltrpn_minus, kltrpn_plus, kmcmdn, kmcsqn, kmtrpn, kna1, kna2, kna3, ko, kres, kresf, kt_2, ktrans, n, nID, nKG, na, nao, p1, p2, p3, pa, pb, pc1, pc2, qca, qna, r1, r2, r3, ra, rad_, rb, rc1, rc2, rhoF1, rhoREF, rhoREN, tauCa, tauK, tauNa, thL, tjca, trpnmax, wca, wna, wnaca, zca, zcl, zeta, zk, zna],
    observed = observed,
    defaults = defaults,
)
